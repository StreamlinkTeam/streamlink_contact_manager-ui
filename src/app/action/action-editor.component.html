<div class="container">
  <div class="row bg-warning" role="tabpanel" *ngIf="!isSocietyContact()">
    <h5 class="dropdown-header text-dark">Actions</h5>
  </div>
  <div class="row">
    <div class="col border">
      <form novalidate #form="ngForm" (ngSubmit)="save(form)">

        <div *ngIf="editing" class="form-group">
          <label class="col-form-label">Date de Cr√©ation: </label>
          <input type="text" readonly class="form-control-plaintext"
                 name="createdDate" style="width: 70%"
                 value="{{action.createdDate | date:'long'}}"/>
        </div>

        <div class="form-row">
          <div class="form-group col-md-6 required">
            <label class="col-form-label">Type</label>
            <select class="form-control" name="type" #type_input="ngModel"
                    [(ngModel)]="action.type" required>
              <option *ngFor="let ff of types" [ngValue]="ff.value">{{ff.label}}</option>
            </select>
            <app-field-error-display
              [model]="type_input"
              [displayError]="form.submitted && type_input.invalid">
            </app-field-error-display>

          </div>

          <div class="form-group col-md-6">
            <label class="col-form-label">Date</label>
            <input class="form-control"
                   type="datetime-local" name="date" [(ngModel)]="action.date"/>
          </div>
        </div>

        <div class="form-group" *ngIf="isSociety()">
          <label>Contact</label> <select class="form-control" required #contact_input="ngModel"
                                         name="societyContactReference" [(ngModel)]="action.societyContactReference">
          <option *ngFor="let contact of contacts" [ngValue]="contact.reference">{{contact.firstname}}
            {{contact.lastname}}
          </option>
        </select>
          <app-field-error-display
            [model]="contact_input"
            fieldName="Contact"
            [displayError]="form.submitted && contact_input.invalid">
          </app-field-error-display>

        </div>

        <div class="form-group required">
          <label class="col-form-label">Note</label>
          <textarea class="form-control" #note_input="ngModel" name="note" rows="5"
                    [(ngModel)]="action.note" required>

			</textarea>

          <app-field-error-display
            [model]="note_input"
            [displayError]="form.submitted && note_input.invalid">
          </app-field-error-display>
        </div>

        <div class="form-group">
          <button type="submit" class="btn btn-warning">Enregistrer</button>
          <button type="reset" class="btn btn-secondary" *ngIf="isDeveloper()"
                  routerLink="/developers">Annuler
          </button>
          <button type="reset" class="btn btn-secondary" *ngIf="isResource()"
                  routerLink="/resources">Annuler
          </button>
          <button type="reset" class="btn btn-secondary" *ngIf="isSocietyContact()"
                  routerLink="/societies/edit/{{societyReference}}/contacts">Annuler
          </button>

          <button type="reset" class="btn btn-secondary" *ngIf="isSociety()"
                  routerLink="/societies">Annuler
          </button>

          <button type="reset" class="btn btn-secondary" *ngIf="isProject()"
                  routerLink="/projects">Annuler
          </button>

          <button *ngIf="editing" type="button" class="btn btn-primary"
                  (click)="newAction(form)">Nouveau
          </button>
        </div>

        <table *ngIf="actions?.length > 0"
               class="table table-striped table-sm">
          <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Type</th>
            <th scope="col">Note</th>
            <th scope="col">Responsable</th>
            <th scope="col" *ngIf="isSociety()">Contact</th>
            <th scope="col">Date</th>
            <th scope="col"></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let act of actions; let i=index">
            <td>{{i+1}}</td>
            <td>
              <app-custom-enum-render [value]="act.type"></app-custom-enum-render>

            </td>
            <td>{{act.note}}</td>
            <td>{{act.responsibleFullName}}</td>
            <td *ngIf="isSociety()">{{act.societyContactFullName}}</td>
            <td>{{act.date | date:'short'}}</td>
            <td>
              <button type="button" class="btn btn-sm btn-info fa fa-edit"
                      (click)="showAction(i,form)">
              </button>
              <button type="button" class="btn btn-sm btn-danger fa fa-trash"
                      (click)="deleteAction(i)">
              </button>
            </td>
          </tr>
          </tbody>
        </table>
      </form>
    </div>
  </div>
</div>
